{
    "version": "https://jsonfeed.org/version/1",
    "title": "jQueryZK Blog • All posts by \"python网络爬虫\" category",
    "description": "过去无法挽回，未来可以改变",
    "home_page_url": "http://yoursite.com",
    "items": [
        {
            "id": "http://yoursite.com/2020/08/25/python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB-%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98-(%E7%88%AC%E5%8F%96%E7%BD%91%E6%98%93%E4%BA%91%E8%96%9B%E4%B9%8B%E8%B0%A6%E6%AD%8C%E5%8D%95%E9%87%8C%E6%AD%8C%E6%9B%B2%E5%B9%B6%E4%B8%8B%E8%BD%BD)/",
            "url": "http://yoursite.com/2020/08/25/python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB-%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98-(%E7%88%AC%E5%8F%96%E7%BD%91%E6%98%93%E4%BA%91%E8%96%9B%E4%B9%8B%E8%B0%A6%E6%AD%8C%E5%8D%95%E9%87%8C%E6%AD%8C%E6%9B%B2%E5%B9%B6%E4%B8%8B%E8%BD%BD)/",
            "title": "python网络爬虫-爬虫实战-(爬取网易云薛之谦歌单里歌曲并下载)",
            "date_published": "2020-08-25T13:05:52.362Z",
            "content_html": "<h1 id=\"1-导入要用到的库\"><a class=\"markdownIt-Anchor\" href=\"#1-导入要用到的库\">#</a> 1、导入要用到的库</h1>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#导入库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">from</span> fake_useragent <span class=\"keyword\">import</span> UserAgent</span><br><span class=\"line\"><span class=\"keyword\">from</span> lxml <span class=\"keyword\">import</span> etree</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br></pre></td></tr></table></figure>\n<p>很多初学 python 的同学不知道如何下载第三方库，我在这介绍一种和简单的方法<br>\n 1：首先准备好下载命令</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m pip install 想要的库的名称  --trusted-host=pypi.python.org --trusted-host=pypi.org --trusted-host=files.pythonhosted.org</span><br></pre></td></tr></table></figure>\n<p>把自己想要下载的库的名称替换掉命令中的 &quot;想要的库的名称&quot;，比如下载 lxml 第三方库的命令如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m pip install lxml  --trusted-host=pypi.python.org --trusted-host=pypi.org --trusted-host=files.pythonhosted.org</span><br></pre></td></tr></table></figure>\n<p>2：在 Pycharm 的 Terminal 中执行这行命令<br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824102402269.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n如图所示，回车即可。</p>\n<h1 id=\"2-分析获取网址\"><a class=\"markdownIt-Anchor\" href=\"#2-分析获取网址\">#</a> 2、分析获取网址</h1>\n<p>进入网易云官网搜索 &quot;薛之谦&quot;<br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824102901217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n得到一个网址为 &quot;<a href=\"https://music.163.com/#/artist?id=5781\">https://music.163.com/#/artist?id=5781</a>&quot;<br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824102959573.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n很明显这不是真正的请求网址，检查网页，重新搜索薛之谦在 network doc 下会有一个新的请求文件点进去看到的 Request URL: <a href=\"https://music.163.com/artist?id=5781\">https://music.163.com/artist?id=5781</a> 就是我们想要的请求 url<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824103344295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n这时候我们可以先把这个页面的内容爬取打印出来，看一下是不是我们要的东西</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">url = <span class=\"string\">&#x27;https://music.163.com/artist?id=5781&#x27;</span></span><br><span class=\"line\">headers= &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;User-Agent&quot;</span>: UserAgent().chrome</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">result = requests.get(url, headers=headers).text</span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n<p><img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/2020082410404514.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n看到这就知道确实是爬取了薛之谦第一页歌单的信息<br>\n接下来分析每一首歌的网址信息<br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824105043124.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n用同样的方法检查后获取到<br>\n Request URL: <a href=\"https://music.163.com/song?id=1463165983\">https://music.163.com/song?id=1463165983</a><br>\n 通过简单分析可以知道 id 就记录是那一首歌</p>\n<h1 id=\"3-删选数据\"><a class=\"markdownIt-Anchor\" href=\"#3-删选数据\">#</a> 3、删选数据</h1>\n<p>我们可以看到，爬取的歌单内容里面虽然有我们想要的数据，却也有大量不需要的内容，此时我们需要删选数据获取列表中的歌曲 id，储存在一个字典中，里面每个元素为每首歌的 id</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dom =etree.HTML(result)</span><br><span class=\"line\"><span class=\"comment\"># 通过审查元素发现每首歌在&lt;a href=&quot;/song?id=417859631&quot;&gt; 中通过xpath分析得获取所有歌曲id的xpath语句为&#x27;//a[contains(@href,&quot;/song?&quot;)]/@href&#x27;</span></span><br><span class=\"line\">ids = dom.xpath(<span class=\"string\">&#x27;//ul[@class=&quot;f-hide&quot;]//li/a/@href&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#将数据切片只需要id数值</span></span><br><span class=\"line\"><span class=\"comment\">#正则表达式</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(ids)):</span><br><span class=\"line\">    ids[i] = re.sub(<span class=\"string\">&#x27;\\D&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, ids[i])</span><br><span class=\"line\">print(ids)</span><br></pre></td></tr></table></figure>\n<p><img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824105306387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n此时我们就获得了这一页薛之谦歌单里的每一首歌的 id 值并存在了一个字典里<br>\n通过一个 for 循环验证我们的成果</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(ids)):</span><br><span class=\"line\">    <span class=\"comment\">#每一首歌的地址</span></span><br><span class=\"line\">    M_url = <span class=\"string\">f&#x27;https://music.163.com/song?id=<span class=\"subst\">&#123;ids[i]&#125;</span>&#x27;</span></span><br><span class=\"line\">    response = requests.get(M_url, headers=headers)</span><br><span class=\"line\">    html = etree.HTML(response.text)</span><br><span class=\"line\">    music_info = html.xpath(<span class=\"string\">&#x27;//title/text()&#x27;</span>)</span><br><span class=\"line\">    music_name = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">    singer = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\">    print(music_name, singer) </span><br></pre></td></tr></table></figure>\n<p><img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824110127191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n可以看到我们通过每一首歌的网址爬取了每一首歌的歌名和歌手名</p>\n<h1 id=\"4-获取歌源\"><a class=\"markdownIt-Anchor\" href=\"#4-获取歌源\">#</a> 4、获取歌源</h1>\n<p>接下来进入最重要的环节，获取歌源，我们之前做的只是获取到每首歌的 url 信息但那些并不可以实现播放，我们需要通过外链来生成 mp3 文件<br>\n为网易云音乐的外链地址：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">base_url = <span class=\"string\">&#x27;https://link.hhtjim.com/163/&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>在这介绍一个可以获取各大音乐平台外链信息的网址  <a href=\"https://link.hhtjim.com/\">跳转</a><br>\n通过拼接每一首歌的 id 信息获得每一首歌的外链网址</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">base_url = <span class=\"string\">&#x27;https://link.hhtjim.com/163/&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(ids)):</span><br><span class=\"line\">    <span class=\"comment\">#每一首歌的地址</span></span><br><span class=\"line\">    M_url = <span class=\"string\">f&#x27;https://music.163.com/song?id=<span class=\"subst\">&#123;ids[i]&#125;</span>&#x27;</span></span><br><span class=\"line\">    response = requests.get(M_url, headers=headers)</span><br><span class=\"line\">    html = etree.HTML(response.text)</span><br><span class=\"line\">    music_info = html.xpath(<span class=\"string\">&#x27;//title/text()&#x27;</span>)</span><br><span class=\"line\">    music_name = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">    singer = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\">    print(music_name, singer)</span><br><span class=\"line\">    music_url = base_url + str(ids[i]) + <span class=\"string\">&#x27;.mp3&#x27;</span></span><br><span class=\"line\">    print(music_url)</span><br></pre></td></tr></table></figure>\n<p><img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824111032642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"5-下载歌曲\"><a class=\"markdownIt-Anchor\" href=\"#5-下载歌曲\">#</a> 5、下载歌曲</h1>\n<p>在项目当前文件下建一个 music 文件夹来储存爬取的歌曲文件，文件格式为 mp3 格式 ，<br>\nwb:\t以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> open(<span class=\"string\">&#x27;./music/&#x27;</span>+music_name+<span class=\"string\">&#x27;.mp3&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> file:</span><br><span class=\"line\">       file.write(music)</span><br><span class=\"line\">   print(<span class=\"string\">&quot;正在下载第&quot;</span>+str(i+<span class=\"number\">1</span>)+<span class=\"string\">&quot;首:  &quot;</span>+music_name+singer)</span><br></pre></td></tr></table></figure>\n<p><img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/2020082411170898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824112505309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n去本地对应的文件下就可以找到这些音乐啦<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824112615921.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n<img src= \"/img/loading.gif\" data-lazy-src=\"https://img-blog.csdnimg.cn/20200824112727851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI3OTE3OA==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"在这里插入图片描述\"><br>\n可以用任何音乐播放器播放。</p>\n<h1 id=\"6-总的代码\"><a class=\"markdownIt-Anchor\" href=\"#6-总的代码\">#</a> 6、总的代码</h1>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#导入库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">from</span> fake_useragent <span class=\"keyword\">import</span> UserAgent</span><br><span class=\"line\"><span class=\"keyword\">from</span> lxml <span class=\"keyword\">import</span> etree</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"comment\">#网易云官网 搜索薛之谦跳转网页后  检查  network  doc 找到该网页的</span></span><br><span class=\"line\"><span class=\"comment\">#Request URL: https://music.163.com/artist?id=5781</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#1、确定url地址(薛之谦的歌单）</span></span><br><span class=\"line\">url = <span class=\"string\">&#x27;https://music.163.com/artist?id=5781&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#网易云音乐的外链地址</span></span><br><span class=\"line\">base_url = <span class=\"string\">&#x27;https://link.hhtjim.com/163/&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#2、请求</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers= &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;User-Agent&quot;</span>: UserAgent().chrome</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">result = requests.get(url, headers=headers).text</span><br><span class=\"line\"><span class=\"comment\"># print(result)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#3、删选数据 拿到列表中的歌曲id  为一个字典 里面有每首个的id</span></span><br><span class=\"line\">dom =etree.HTML(result)</span><br><span class=\"line\"><span class=\"comment\"># 通过审查元素发现每首歌在&lt;a href=&quot;/song?id=417859631&quot;&gt; 中通过xpath分析得获取所有歌曲id的xpath语句为&#x27;//a[contains(@href,&quot;/song?&quot;)]/@href&#x27;</span></span><br><span class=\"line\">ids = dom.xpath(<span class=\"string\">&#x27;//ul[@class=&quot;f-hide&quot;]//li/a/@href&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#将数据切片只需要id数值</span></span><br><span class=\"line\"><span class=\"comment\">#正则表达式</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(ids)):</span><br><span class=\"line\">    ids[i] = re.sub(<span class=\"string\">&#x27;\\D&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, ids[i])</span><br><span class=\"line\"><span class=\"comment\">#print(ids)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(ids)):</span><br><span class=\"line\">    <span class=\"comment\">#每一首歌的地址</span></span><br><span class=\"line\">    M_url = <span class=\"string\">f&#x27;https://music.163.com/song?id=<span class=\"subst\">&#123;ids[i]&#125;</span>&#x27;</span></span><br><span class=\"line\">    response = requests.get(M_url, headers=headers)</span><br><span class=\"line\">    html = etree.HTML(response.text)</span><br><span class=\"line\">    music_info = html.xpath(<span class=\"string\">&#x27;//title/text()&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\">#print(music_info)   #[&#x27;我好像在哪见过你（电影《精灵王座》主题曲） - 薛之谦 - 单曲 - 网易云音乐&#x27;]</span></span><br><span class=\"line\">    music_name = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">    singer = music_info[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;-&#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\">    <span class=\"comment\">#print(music_name, singer)  #我好像在哪见过你（电影《精灵王座》主题曲）   薛之谦</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取歌源</span></span><br><span class=\"line\">    music_url = base_url + str(ids[i]) + <span class=\"string\">&#x27;.mp3&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\">#print(music_url)    #打印出每首歌的外链网址</span></span><br><span class=\"line\">    music = requests.get(music_url).content</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#4、保存</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> open(<span class=\"string\">&#x27;./music/&#x27;</span>+music_name+<span class=\"string\">&#x27;.mp3&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> file:</span><br><span class=\"line\">        file.write(music)</span><br><span class=\"line\">    print(<span class=\"string\">&quot;正在下载第&quot;</span>+str(i+<span class=\"number\">1</span>)+<span class=\"string\">&quot;首:  &quot;</span>+music_name+singer)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>欢迎持续关注！</p>\n",
            "tags": [
                "python",
                "网络爬虫"
            ]
        }
    ]
}